<!DOCTYPE html>
<html>
<head>
    <title>Pharmacy POS Receipt</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        #thermal-pos {
            width: 80mm; /* Adjust the width as per your printer paper size */
            margin: 0 auto;
            font-size: 12px;
        }

        #thermal-pos table {
            width: 100%;
            border-collapse: collapse;
        }

        #thermal-pos th, #thermal-pos td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        #thermal-pos th {
            background-color: #4CAF50;
            color: white;
        }

        #thermal-pos tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        #thermal-pos tr:hover {
            background-color: #ddd;
        }

        /* Adjust the font size for the receipt */
        #thermal-pos th, #thermal-pos td {
            font-size: 12px;
        }

        /* Right align the subtotal */
        .subtotal {
            text-align: right;
        }

        /* Left align the quantity x price */
        .qty-price {
            text-align: left;
        }
    </style>
</head>
<body>
    <div id="thermal-pos">
        <!-- Your receipt content will be dynamically generated here -->
    </div>

    <script>
        // Parse the query parameters to get the data for the receipt
        const urlParams = new URLSearchParams(window.location.search);
        const invoice = urlParams.get('invoice');
        const date = urlParams.get('date');
        const customer = urlParams.get('customer');
        const phone = urlParams.get('phone');
        const clinic = urlParams.get('clinic');
        const address = urlParams.get('address');
        const contact = urlParams.get('contact');
        const total = urlParams.get('total');
        const payment = urlParams.get('payment');
        const balance = urlParams.get('balance');
        const items = urlParams.get('items').split(',');
        const prices = urlParams.get('price').split(',');
        const quantities = urlParams.get('qty').split(',');
        const subtotals = urlParams.get('sub_total').split(',');

        // Create an array to hold the items
        const result = [];

        // Iterate over the items to create objects and push them into the result array
        items.forEach((value, id) => {
            result[id] = {
                item: items[id],
                price: prices[id],
                qty: quantities[id],
                sub_total: subtotals[id]
            };
        });

        // Render the receipt using the result array
        const thermalPos = document.getElementById('thermal-pos');
        const table = document.createElement('table');
        result.forEach(row => {
            const trItem = document.createElement('tr');
            const tdItem = document.createElement('td');
            tdItem.textContent = row.item;
            const tdSubTotal = document.createElement('td');
            tdSubTotal.textContent = 'K' + row.sub_total;
            tdSubTotal.classList.add('subtotal');
            trItem.appendChild(tdItem);
            trItem.appendChild(tdSubTotal);
            table.appendChild(trItem);

            const trQtyPrice = document.createElement('tr');
            const tdQtyPrice = document.createElement('td');
            tdQtyPrice.textContent = row.qty + ' x ' + row.price;
            tdQtyPrice.classList.add('qty-price');
            trQtyPrice.appendChild(tdQtyPrice);
            table.appendChild(trQtyPrice);
        });
        thermalPos.appendChild(table);

        // Add total, payment, and balance to the receipt
        const totalRow = document.createElement('tr');
        const tdTotalLabel = document.createElement('th');
        tdTotalLabel.textContent = 'Total';
        const tdTotalValue = document.createElement('td');
        tdTotalValue.textContent = total;
        totalRow.appendChild(tdTotalLabel);
        totalRow.appendChild(tdTotalValue);
        table.appendChild(totalRow);

        const paymentRow = document.createElement('tr');
        const tdPaymentLabel = document.createElement('th');
        tdPaymentLabel.textContent = 'Payment';
        const tdPaymentValue = document.createElement('td');
        tdPaymentValue.textContent = payment;
        paymentRow.appendChild(tdPaymentLabel);
        paymentRow.appendChild(tdPaymentValue);
        table.appendChild(paymentRow);

        const balanceRow = document.createElement('tr');
        const tdBalanceLabel = document.createElement('th');
        tdBalanceLabel.textContent = 'Balance';
        const tdBalanceValue = document.createElement('td');
        tdBalanceValue.textContent = balance;
        balanceRow.appendChild(tdBalanceLabel);
        balanceRow.appendChild(tdBalanceValue);
        table.appendChild(balanceRow);

        // Add the footer
        const footerTable = document.createElement('table');
        const footerRow = document.createElement('tr');
        const tdDate = document.createElement('td');
        tdDate.textContent = 'Date: ' + date;
        const tdInvoice = document.createElement('td');
        tdInvoice.textContent = 'Invoice: ' + invoice;
        footerRow.appendChild(tdDate);
        footerRow.appendChild(tdInvoice);
        footerTable.appendChild(footerRow);
        thermalPos.appendChild(footerTable);

        // Add customer information
        const customerTable = document.createElement('table');
        const customerRow = document.createElement('tr');
        const tdCustomerLabel = document.createElement('th');
        tdCustomerLabel.textContent = 'Customer';
        const tdCustomerValue = document.createElement('td');
        tdCustomerValue.textContent = customer + ' (' + phone + ')';
        customerRow.appendChild(tdCustomerLabel);
        customerRow.appendChild(tdCustomerValue);
        customerTable.appendChild(customerRow);

        const clinicRow = document.createElement('tr');
        const tdClinicLabel = document.createElement('th');
        tdClinicLabel.textContent = 'Clinic';
        const tdClinicValue = document.createElement('td');
        tdClinicValue.textContent = clinic;
        clinicRow.appendChild(tdClinicLabel);
        clinicRow.appendChild(tdClinicValue);
        customerTable.appendChild(clinicRow);

        const addressRow = document.createElement('tr');
        const tdAddressLabel = document.createElement('th');
        tdAddressLabel.textContent = 'Address';
        const tdAddressValue = document.createElement('td');
        tdAddressValue.textContent = address;
        addressRow.appendChild(tdAddressLabel);
        addressRow.appendChild(tdAddressValue);
        customerTable.appendChild(addressRow);

        const contactRow = document.createElement('tr');
        const tdContactLabel = document.createElement('th');
        tdContactLabel.textContent = 'Contact';
        const tdContactValue = document.createElement('td');
        tdContactValue.textContent = contact;
        contactRow.appendChild(tdContactLabel);
        contactRow.appendChild(tdContactValue);
        customerTable.appendChild(contactRow);

        thermalPos.appendChild(customerTable);

        // Print the receipt
        window.print();
    </script>
</body>
</html>